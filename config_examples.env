# WhisperX Configuration Examples
# Copy the appropriate section to your .env file or export directly

# ==============================================================================
# CUSTOMER FEEDBACK OPTIMIZED (Accuracy Priority)
# Addresses: punctuation, speaker over-detection, speaker turns
# Performance: 15x faster than realtime on RTX 3090
# ==============================================================================
export WHISPERX_COMPUTE_TYPE=float32
export WHISPERX_BATCH_SIZE=8
export WHISPERX_CHAR_ALIGN=true
export MAX_CONCURRENT_REQUESTS=4
export MEMORY_PER_REQUEST_GB=6.0

# Addressing customer feedback issues
export WHISPERX_CHUNK_LENGTH=15
export VAD_ONSET=0.500                    # UPDATED: Less sensitive to reduce over-detection
export VAD_OFFSET=0.200                   # UPDATED: Tighter boundaries
export ALIGN_MODEL=WAV2VEC2_ASR_LARGE_LV60K_960H
export INTERPOLATE_METHOD=linear
export SEGMENT_RESOLUTION=sentence
export ENABLE_REQUEST_QUEUING=false

# ==============================================================================
# BALANCED PRODUCTION (Speed vs Accuracy Balance) 
# Performance: ~20x faster than realtime on RTX 3090 (estimated)
# ==============================================================================
export WHISPERX_COMPUTE_TYPE=float16
export WHISPERX_BATCH_SIZE=12
export WHISPERX_CHAR_ALIGN=false
export MAX_CONCURRENT_REQUESTS=5
export MEMORY_PER_REQUEST_GB=4.5

# Production optimizations
export WHISPERX_CHUNK_LENGTH=20
export VAD_ONSET=0.450
export VAD_OFFSET=0.250
export ALIGN_MODEL=WAV2VEC2_ASR_BASE_960H
export INTERPOLATE_METHOD=linear
export SEGMENT_RESOLUTION=chunk
export ENABLE_REQUEST_QUEUING=true
export QUEUE_TIMEOUT=300

# ==============================================================================  
# H100 HIGH THROUGHPUT (Maximum Concurrency)
# Performance: ~25-30x faster than realtime (projected)
# ==============================================================================
export WHISPERX_COMPUTE_TYPE=float16
export WHISPERX_BATCH_SIZE=16
export WHISPERX_CHAR_ALIGN=false
export MAX_CONCURRENT_REQUESTS=15
export MEMORY_PER_REQUEST_GB=5.0

# High throughput settings
export WHISPERX_CHUNK_LENGTH=25
export VAD_ONSET=0.450
export VAD_OFFSET=0.250
export ALIGN_MODEL=WAV2VEC2_ASR_BASE_960H
export INTERPOLATE_METHOD=linear
export SEGMENT_RESOLUTION=chunk
export ENABLE_REQUEST_QUEUING=true
export QUEUE_TIMEOUT=600

# ==============================================================================
# DEVELOPMENT/TESTING (Maximum Accuracy, Lower Concurrency)
# Performance: 15x faster than realtime on RTX 3090
# ==============================================================================
export WHISPERX_COMPUTE_TYPE=float32
export WHISPERX_BATCH_SIZE=6
export WHISPERX_CHAR_ALIGN=true
export MAX_CONCURRENT_REQUESTS=2
export MEMORY_PER_REQUEST_GB=8.0

# Maximum accuracy settings
export WHISPERX_CHUNK_LENGTH=10
export VAD_ONSET=0.500
export VAD_OFFSET=0.200
export ALIGN_MODEL=WAV2VEC2_ASR_LARGE_LV60K_960H
export INTERPOLATE_METHOD=linear
export SEGMENT_RESOLUTION=word
export ENABLE_REQUEST_QUEUING=false

# ==============================================================================
# ADDITIONAL SETTINGS
# ==============================================================================

# Memory monitoring
export MEMORY_CHECK_INTERVAL=30

# API settings  
export API_HOST=0.0.0.0
export API_PORT=3333

# Hugging Face token for diarization (optional)
# export HUGGINGFACE_TOKEN=your_token_here

# ==============================================================================
# PERFORMANCE NOTES (ACTUAL MEASURED RESULTS)
# ==============================================================================
# RTX 3090 Results (customer feedback optimized config):
# - 10-minute audio: 39 seconds processing (15.5x faster than realtime)
# - 1-minute audio: 4.4 seconds processing (13.6x faster than realtime)
# - Concurrent capacity: 4 requests = ~3600+ minutes/hour throughput
# 
# IMPORTANT: Speaker over-detection observed in testing.
# Use min_speakers/max_speakers parameters in API calls:
# curl -F "min_speakers=2" -F "max_speakers=2" ... 